# –ú–æ–¥—É–ª—å: ext_card.py

## –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å `ext_card.py` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≥—Ä—É–ø–ø –≤ —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º. –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ —Å–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏ (–Ω–æ–º–µ—Ä–∞ –ø–∞—Ä—ã), –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è –∏ –∞—É–¥–∏—Ç–æ—Ä–∏–∏.

–ú–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –ø–æ —Ç–∏–ø—É Git, –ø–æ–∑–≤–æ–ª—è—è:
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
- –£—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞–º
- –ú–∞—Å—Å–æ–≤–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã –≤ –æ–¥–Ω–æ –≤—Ä–µ–º—è)

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**
- **card_hist_id** - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **ttable_id (sched_ver_id)** - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, —Å–≤—è–∑—ã–≤–∞—é—â–∏–π –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –µ–¥–∏–Ω—É—é –≤–µ—Ä—Å–∏—é
- **–£—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è** - "–ø—Ä–æ–¥–æ–≤–∞—è" –≤–µ—Ä—Å–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, –≤–∏–¥–∏–º–∞—è —Å—Ç—É–¥–µ–Ω—Ç–∞–º, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
- **–°—Ç–∞—Ç—É—Å—ã –∫–∞—Ä—Ç–æ—á–µ–∫**: —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ (1), —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ (2), —á–µ—Ä–Ω–æ–≤–∏–∫ (3)

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

**–ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å:** `/api/v1/private/n8n_ui/cards`

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç –±–∞–∑–æ–≤—ã–π –ø—É—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä, —ç–Ω–¥–ø–æ–∏–Ω—Ç `/get_by_id` –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –ø–æ–ª–Ω–æ–º—É –ø—É—Ç–∏ `/api/v1/private/n8n_ui/cards/get_by_id`.

### üì• POST /cards/get_by_id

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞—Ä—Ç–æ—á–∫–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É –∏–ª–∏ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ –µ—ë —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –∑–∞–Ω—è—Ç–∏–π: –ø–æ–∑–∏—Ü–∏—é, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è (ID –∏ –§–ò–û) –∏ –∞—É–¥–∏—Ç–æ—Ä–∏—é.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "card_hist_id": 150
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞:**
- `card_hist_id` (int): ID –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏

**–û—Ç–≤–µ—Ç:**
```json
{
  "ext_card": [
    {
      "position": 1,
      "teacher_name": "–ò–≤–∞–Ω–æ–≤ –ò.–ò.",
      "teacher_id": 1,
      "aud": "101"
    },
    {
      "position": 2,
      "teacher_name": "–ü–µ—Ç—Ä–æ–≤–∞ –ê.–°.",
      "teacher_id": 2,
      "aud": "205"
    }
  ]
}
```

**Middleware:**
- `role_require(Roles.methodist, Roles.read_all)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞ (—á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å) –∏–ª–∏ read_all (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ cookie

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.get_ext_card()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Ä—Ç–æ—á–∫–µ –∏–∑ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–æ—á–∫–∏

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏
- 403: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

---

### üíæ POST /cards/save

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è. –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –ª—é–±–æ–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã –≤ –æ–¥–Ω–æ –≤—Ä–µ–º—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "card_hist_id": 150,
  "ttable_id": 42,
  "lessons": [
    {
      "position": 1,
      "discipline_id": 5,
      "teacher_id": 3,
      "aud": "101",
      "is_force": false
    },
    {
      "position": 2,
      "discipline_id": 7,
      "teacher_id": 4,
      "aud": "205",
      "is_force": false
    }
  ]
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞:**
- `card_hist_id` (int): ID —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
- `ttable_id` (int): ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- `lessons` (List[CardLessonPayload]): –°–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π
  - `position` (int): –ù–æ–º–µ—Ä –ø–∞—Ä—ã
  - `discipline_id` (int): ID –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã
  - `teacher_id` (int): ID –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
  - `aud` (str): –ê—É–¥–∏—Ç–æ—Ä–∏—è (–º–æ–∂–µ—Ç –±—ã—Ç—å –±—É–∫–≤–µ–Ω–Ω–æ–π)
  - `is_force` (bool): –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã)

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "message": "Card saved successfully",
  "new_card_hist_id": 151
}
```

**–û—Ç–≤–µ—Ç (–∫–æ–Ω—Ñ–ª–∏–∫—Ç):**
```json
{
  "success": false,
  "message": "Conflicts detected during save",
  "conflicts": {
    "columns": ["position", "teacher_id", "sched_ver_id"],
    "values": [1, 3, 42]
  },
  "description": "–£ —ç—Ç–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è —É–∂–µ –µ—Å—Ç—å –≥—Ä—É–ø–ø–∞ –Ω–∞ —ç—Ç—É –ø–∞—Ä—É"
}
```

**–û—Ç–≤–µ—Ç (–∑–∞–ø—Ä–µ—â–µ–Ω–æ):**
```json
{
  "success": false,
  "conflicts": {},
  "description": "–í–µ—Ä—Å–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–∂–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω—ã"
}
```

**Middleware:**
- `role_require(Roles.methodist)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞ (—Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å—å)
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.save_card()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –ë–î
- `create_cards_save_response()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
- `create_response_json()` - —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ JSON –æ—Ç–≤–µ—Ç–∞
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –ª–∏ –≤–µ—Ä—Å–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (–µ—Å–ª–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ - –≤–æ–∑–≤—Ä–∞—Ç 403)
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –Ω–æ–≤—ã–º card_hist_id
3. –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–æ –∏–Ω–¥–µ–∫—Å—É (position, teacher_id, sched_ver_id, is_force=false)
4. –ï—Å–ª–∏ is_force=true, –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç (—Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –ø–æ –ø–æ–ª—é success)
- 403: –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

---

### üìú GET /cards/history

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥—Ä—É–ø–ø—ã –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ò—Å—Ç–æ—Ä–∏—è" –≤ –æ–∫–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, –≤–Ω–µ—Å—ë–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–∏—Å—Ç–∞–º–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `sched_ver_id` (int): ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- `group_id` (int): ID –≥—Ä—É–ø–ø—ã

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–û—Ç–≤–µ—Ç:**
```json
{
  "history": [
    {
      "card_hist_id": 100,
      "created_at": "2024-01-15T10:30:00Z",
      "user_id": 1,
      "user_name": "–ò–≤–∞–Ω–æ–≤ –ò.–ò.",
      "status_id": 2,
      "is_current": true
    },
    {
      "card_hist_id": 99,
      "created_at": "2024-01-14T15:20:00Z",
      "user_id": 2,
      "user_name": "–ü–µ—Ç—Ä–æ–≤–∞ –ê.–°.",
      "status_id": 1,
      "is_current": false
    }
  ]
}
```

**–ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞:**
- `card_hist_id` (int): ID –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
- `created_at` (datetime): –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ—Ä—Å–∏–∏
- `user_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–∑–¥–∞–≤—à–µ–≥–æ –≤–µ—Ä—Å–∏—é
- `user_name` (str): –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `status_id` (int): –°—Ç–∞—Ç—É—Å –∫–∞—Ä—Ç–æ—á–∫–∏ (1-—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ, 2-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ, 3-—á–µ—Ä–Ω–æ–≤–∏–∫)
- `is_current` (bool): –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–∞ –≤–µ—Ä—Å–∏—è —Ç–µ–∫—É—â–µ–π (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ UI)

**Middleware:**
- `role_require(Roles.methodist, Roles.read_all)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞ –∏–ª–∏ read_all
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.get_cards_history()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∏—Å—Ç–æ—Ä–∏–∏

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
- 403: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

---

### üìÑ GET /cards/history_content

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫–∏–µ –∑–∞–Ω—è—Ç–∏—è –±—ã–ª–∏ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `card_hist_id` (int): ID –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–û—Ç–≤–µ—Ç:**
```json
{
  "card_content": [
    {
      "position": 1,
      "aud": "101",
      "discipline_id": 1,
      "discipline_title": "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",
      "teacher_id": 1,
      "teacher_name": "–ò–≤–∞–Ω–æ–≤ –ò.–ò."
    },
    {
      "position": 2,
      "aud": "205",
      "discipline_id": 2,
      "discipline_title": "–§–∏–∑–∏–∫–∞",
      "teacher_id": 2,
      "teacher_name": "–ü–µ—Ç—Ä–æ–≤–∞ –ê.–°."
    }
  ]
}
```

**Middleware:**
- `role_require(Roles.methodist, Roles.read_all)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞ –∏–ª–∏ read_all
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.get_card_content()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–µ—Ä—Å–∏–∏ –∏–∑ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- 403: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

---

### ‚úÖ PUT /cards/accept

**–û–ø–∏—Å–∞–Ω–∏–µ:** –£—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, –ø–µ—Ä–µ–≤–æ–¥—è –µ—ë –≤ —Å—Ç–∞—Ç—É—Å "–£—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ". –£—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–∞—Å—Ç—å—é "–ø—Ä–æ–¥–æ–≤–æ–π" –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, –≤–∏–¥–∏–º–æ–π —Å—Ç—É–¥–µ–Ω—Ç–∞–º. –î–ª—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º: –≤—Å–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã, –Ω–µ –º–µ–Ω–µ–µ 2 –∑–∞–Ω—è—Ç–∏–π, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π group_id —Å—Ä–µ–¥–∏ —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "card_hist_id": 150
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞:**
- `card_hist_id` (int): ID –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "message": "–ö–∞—Ä—Ç–æ—á–∫–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!"
}
```

**Middleware:**
- `role_require(Roles.methodist)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.accept_card()` - —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**
–ö–∞—Ä—Ç–æ—á–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
1. –í—Å–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã (–Ω–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π)
2. –í –∫–∞—Ä—Ç–æ—á–∫–µ –Ω–µ –º–µ–Ω–µ–µ 2 –∑–∞–Ω—è—Ç–∏–π
3. –≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –¥–∞–Ω–Ω—ã–º group_id —Å—Ä–µ–¥–∏ —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã—Ö
4. –í–µ—Ä—Å–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –Ω–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ (–∏–Ω–∞—á–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ)

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- 403: –í–µ—Ä—Å–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–∂–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω—ã
- 409: –ö–∞—Ä—Ç–æ—á–∫–∞ –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—è–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

---

### ‚úèÔ∏è PUT /cards/switch_as_edit

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É –≤ —Å—Ç–∞—Ç—É—Å "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ". –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ —Ç–æ–≥–æ, —á—Ç–æ –∫–∞—Ä—Ç–æ—á–∫–∞ –±—ã–ª–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –∏ –µ—â—ë –Ω–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ".

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "card_hist_id": 150,
  "ttable_id": 42
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞:**
- `card_hist_id` (int): ID –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
- `ttable_id` (int): ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "message": "–ö–∞—Ä—Ç–æ—á–∫–∞ {card_hist_id: 150, ttable_id: 42} —Ç–µ–ø–µ—Ä—å –≤ —Å—Ç–∞—Ç—É—Å–µ \"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–æ\""
}
```

**Middleware:**
- `role_require(Roles.methodist)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.switch_as_edit()` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- 403: –í–µ—Ä—Å–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —É–∂–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞, –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω—ã

---

### ‚ûï POST /cards/bulk_add

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä—É–ø–ø –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞ (Ctrl+V) –∏–ª–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ —á–µ—Ä–µ–∑ UI. –ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –∏–∑ –±—É—Ñ–µ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–∂–µ—Ç –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ï—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ ID, –æ–Ω–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –ª–æ–º–∞—é—Ç –≤—Å—é –æ–ø–µ—Ä–∞—Ü–∏—é.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "ttable_id": 42,
  "group_names": ["–ò–°-21-1", "–ü–†-21-2"],
  "lessons": [
    {
      "position": 1,
      "discipline_id": 5,
      "teacher_id": 3,
      "aud": "101",
      "is_force": false
    }
  ]
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞:**
- `ttable_id` (int): ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- `group_names` (List[str]): –°–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π –≥—Ä—É–ø–ø –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
- `lessons` (List[CardLessonPayload]): –°–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π (–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º)

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "cards_ids": [150, 151]
}
```

**Middleware:**
- `role_require(Roles.methodist)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.bulk_add_cards()` - –º–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
- 403: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
- 404: –ù–µ –≤—Å–µ –≥—Ä—É–ø–ø—ã –Ω–∞–π–¥–µ–Ω—ã –≤ –ë–î

---

### üóëÔ∏è DELETE /cards/bulk_del

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫, —Ç–∞–∫ –∏ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "card_ids": [150, 151, 152],
  "ttable_id": 42
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ª–∞:**
- `card_ids` (List[int]): –°–ø–∏—Å–æ–∫ ID –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
- `ttable_id` (int): ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

**–û—Ç–≤–µ—Ç (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "message": "–£–¥–∞–ª–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫: 3"
}
```

**Middleware:**
- `role_require(Roles.methodist)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.bulk_delete_cards()` - –º–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- 403: –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏

---

### üì¶ GET /cards/group-box_w_disciplines

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω, –∫–æ—Ç–æ—Ä—ã–µ –∏–∑—É—á–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º UI –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∏—Å—Ü–∏–ø–ª–∏–Ω –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏. –î–∏—Å—Ü–∏–ø–ª–∏–Ω—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã groups_disciplines, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–∏–≤—è–∑–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∫ –≥—Ä—É–ø–ø–∞–º.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `group_id` (int): ID –≥—Ä—É–ø–ø—ã
- `limit` (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–∞–≥–∏–Ω–∞—Ü–∏—è)
- `offset` (int): –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–û—Ç–≤–µ—Ç:**
```json
{
  "group_box": [
    {
      "discipline_id": 1,
      "title": "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"
    },
    {
      "discipline_id": 2,
      "title": "–§–∏–∑–∏–∫–∞"
    }
  ]
}
```

**Middleware:**
- `role_require(Roles.methodist, Roles.read_all)`: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å –º–µ—Ç–æ–¥–∏—Å—Ç–∞ –∏–ª–∏ read_all
- `JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `db.n8n_ui.group_box_w_disciplines()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω –≥—Ä—É–ø–ø—ã –∏–∑ –ë–î
- `log_event()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω (–¥–æ 900+ –∑–∞–ø–∏—Å–µ–π).

**–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤:**
- 200: –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω
- 403: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

## –°—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö

### SaveCardSchema
–°—Ö–µ–º–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.

```python
class SaveCardSchema(BaseModel):
    card_hist_id: int  # ID —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
    ttable_id: int     # ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
    lessons: List[CardLessonPayload]  # –°–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π
```

### CardLessonPayload
–°—Ö–µ–º–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è –≤ –∫–∞—Ä—Ç–æ—á–∫–µ.

```python
class CardLessonPayload(BaseModel):
    position: int        # –ù–æ–º–µ—Ä –ø–∞—Ä—ã (1, 2, 3, ...)
    discipline_id: int   # ID –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã
    teacher_id: int      # ID –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
    aud: str            # –ê—É–¥–∏—Ç–æ—Ä–∏—è (–º–æ–∂–µ—Ç –±—ã—Ç—å –±—É–∫–≤–µ–Ω–Ω–æ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä "101" –∏–ª–∏ "–ê-205")
    is_force: bool = False  # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã)
```

### BulkCardsSchema
–°—Ö–µ–º–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫.

```python
class BulkCardsSchema(BaseModel):
    ttable_id: int              # ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
    group_names: list[str]      # –°–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π –≥—Ä—É–ø–ø
    lessons: List[CardLessonPayload]  # –°–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç–∏–π
```

### DelCardsSchema
–°—Ö–µ–º–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫.

```python
class DelCardsSchema(BaseModel):
    card_ids: list[int]  # –°–ø–∏—Å–æ–∫ ID –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    ttable_id: int       # ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
```

### EditCardSchema
–°—Ö–µ–º–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∫–∞—Ä—Ç–æ—á–∫–∏.

```python
class EditCardSchema(BaseModel):
    card_hist_id: int  # ID –≤–µ—Ä—Å–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
    ttable_id: int     # ID –≤–µ—Ä—Å–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –í–Ω–µ—à–Ω–∏–µ –º–æ–¥—É–ª–∏
- `fastapi`: –§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è API (APIRouter, Depends, Query, Body, HTTPException)
- `starlette.requests`: –û–±—ä–µ–∫—Ç Request –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞
- `typing`: –¢–∏–ø–∏–∑–∞—Ü–∏—è (Annotated, Union)

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–æ–¥—É–ª–∏
- `core.data.postgre.PgSqlDep`: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
- `core.response_schemas.n8n_ui`: –°—Ö–µ–º—ã –æ—Ç–≤–µ—Ç–æ–≤ (CardsHistoryResponse, CardsGetByIdResponse, –∏ –¥—Ä.)
- `core.schemas.cookie_settings_schema.JWTCookieDep`: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ cookie
- `core.schemas.n8n_ui.cards_schemas`: –°—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (SaveCardSchema, BulkCardsSchema, –∏ –¥—Ä.)
- `core.schemas.schemas2depends.PagenDep`: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `core.utils.anything.Roles`: Enum —Å —Ä–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `core.utils.lite_dependencies.role_require`: Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π
- `core.utils.logger.log_event`: –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- `core.utils.response_model_utils`: –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `db.n8n_ui.*`: –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤ PostgreSQL

## Middleware

### role_require(Roles.methodist, Roles.read_all)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –æ–¥–Ω—É –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ä–æ–ª–µ–π:
- `Roles.methodist`: –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (—á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å)
- `Roles.read_all`: –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ (–¥–ª—è –∞–¥–º–∏–Ω–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

–ï—Å–ª–∏ IP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –≤ —Å–ø–∏—Å–∫–µ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –∏ —Ä–æ–ª—å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 403 Forbidden.

### JWTCookieDep
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç JWT —Ç–æ–∫–µ–Ω –≤ cookie `access_token`. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –∏—Å—Ç—ë–∫, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π cookie. –ò–∑–≤–ª–µ–∫–∞–µ—Ç `user_id` –∏ `role` –∏–∑ —Ç–æ–∫–µ–Ω–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `request.state`.

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### HTTPException 403 (Forbidden)
–í–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:
- –ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (—Ä–æ–ª—å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º)

### HTTPException 404 (Not Found)
–í–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–µ–∫, –µ—Å–ª–∏ –Ω–µ –≤—Å–µ –≥—Ä—É–ø–ø—ã –Ω–∞–π–¥–µ–Ω—ã –≤ –ë–î.

### HTTPException 409 (Conflict)
–í–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—è–º (–∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, –º–µ–Ω–µ–µ 2 –∑–∞–Ω—è—Ç–∏–π, –¥—É–±–ª–∏–∫–∞—Ç group_id).

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `log_event()`:
- –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: —É—Ä–æ–≤–µ–Ω—å INFO
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ –æ—à–∏–±–∫–∏: —É—Ä–æ–≤–µ–Ω—å WARNING
- –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ü–≤–µ—Ç–æ–≤—É—é —Ä–∞–∑–º–µ—Ç–∫—É –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π
–ú–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π –ø–æ —Ç–∏–ø—É Git:
- –ö–∞–∂–¥–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –∫–∞—Ä—Ç–æ—á–∫–∏ (–Ω–æ–≤—ã–π card_hist_id)
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –í–æ–∑–º–æ–∂–µ–Ω –æ—Ç–∫–∞—Ç –Ω–∞ –ª—é–±—É—é –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é
- –£—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —á–µ—Ä–µ–∑ –∏–Ω–¥–µ–∫—Å –ë–î –Ω–∞ (position, teacher_id, sched_ver_id, is_force=false):
- –ï—Å–ª–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ –¥—Ä—É–≥—É—é –≥—Ä—É–ø–ø—É –≤ —ç—Ç–æ –≤—Ä–µ–º—è, –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç
- –§–ª–∞–≥ `is_force=true` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### –¢–∏–ø—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:
1. **standard** - –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (building_id, type, schedule_date is null, status_id=1, is_committed=true)
2. **replacements** - –∑–∞–º–µ–Ω—ã –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É (building_id, type, schedule_date, status_id=1, is_committed=true)

### –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **methodist**: –û—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º (—á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å)
- **read_all**: –†–æ–ª—å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∞–¥–º–∏–Ω–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```python
import httpx

response = httpx.post(
    "http://api.example.com/api/v1/private/n8n_ui/cards/get_by_id",
    json={"card_hist_id": 150},
    cookies={"access_token": "your_jwt_token"}
)
ext_card = response.json()["ext_card"]
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞—Ä—Ç–æ—á–∫–∏
```python
response = httpx.post(
    "http://api.example.com/api/v1/private/n8n_ui/cards/save",
    json={
        "card_hist_id": 150,
        "ttable_id": 42,
        "lessons": [
            {
                "position": 1,
                "discipline_id": 5,
                "teacher_id": 3,
                "aud": "101",
                "is_force": False
            }
        ]
    },
    cookies={"access_token": "your_jwt_token"}
)

if response.json()["success"]:
    new_card_hist_id = response.json()["new_card_hist_id"]
    print(f"–ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å –Ω–æ–≤—ã–º ID: {new_card_hist_id}")
else:
    conflicts = response.json()["conflicts"]
    print(f"–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã: {conflicts}")
```

### –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
```python
response = httpx.post(
    "http://api.example.com/api/v1/private/n8n_ui/cards/bulk_add",
    json={
        "ttable_id": 42,
        "group_names": ["–ò–°-21-1", "–ü–†-21-2"],
        "lessons": [
            {
                "position": 1,
                "discipline_id": 5,
                "teacher_id": 3,
                "aud": "101",
                "is_force": False
            }
        ]
    },
    cookies={"access_token": "your_jwt_token"}
)

cards_ids = response.json()["cards_ids"]
print(f"–°–æ–∑–¥–∞–Ω—ã –∫–∞—Ä—Ç–æ—á–∫–∏: {cards_ids}")
```

### –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
```python
response = httpx.put(
    "http://api.example.com/api/v1/private/n8n_ui/cards/accept",
    json={"card_hist_id": 150},
    cookies={"access_token": "your_jwt_token"}
)

if response.status_code == 200:
    print("–ö–∞—Ä—Ç–æ—á–∫–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!")
elif response.status_code == 409:
    print(f"–û—à–∏–±–∫–∞: {response.json()['detail']}")
```
