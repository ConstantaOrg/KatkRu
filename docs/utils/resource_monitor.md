# üìä Resource Monitor

## –û–ø–∏—Å–∞–Ω–∏–µ
–ú–æ–¥—É–ª—å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º. –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é —É—Ç–∏–ª–∏–∑–∞—Ü–∏—é CPU –∏ RAM –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –î–∞–Ω–Ω—ã–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ Elasticsearch –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ Grafana.

## –ö–ª–∞—Å—Å—ã

### üíª `ResourceMonitor`
–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∞—Å—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ —Ä–µ—Å—É—Ä—Å–æ–≤.

**–ú–µ—Ç–æ–¥—ã:**

#### `get_cpu_usage()`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ CPU –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö.

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```python
@staticmethod
def get_cpu_usage() -> float
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `float` - –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ CPU (0-100)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `psutil.cpu_percent(interval=1)`
- –ó–∞–º–µ—Ä –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ä–µ–¥–Ω—é—é –∑–∞–≥—Ä—É–∑–∫—É –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª

**–ü—Ä–∏–º–µ—Ä:**
```python
cpu = ResourceMonitor.get_cpu_usage()
print(f"CPU: {cpu}%")  # CPU: 45.2%
```

---

#### `get_memory_usage()`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```python
@staticmethod
def get_memory_usage() -> dict
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    'total_mb': 2048.0,      # –û–±—â–∏–π –æ–±—ä—ë–º RAM –≤ MB
    'used_mb': 1024.5,       # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ RAM –≤ MB
    'available_mb': 1023.5,  # –î–æ—Å—Ç—É–ø–Ω–æ RAM –≤ MB
    'percent': 50.0          # –ü—Ä–æ—Ü–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `psutil.virtual_memory()`
- –ó–Ω–∞—á–µ–Ω–∏—è –æ–∫—Ä—É–≥–ª–µ–Ω—ã –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
- –í—Å–µ —Ä–∞–∑–º–µ—Ä—ã –≤ –º–µ–≥–∞–±–∞–π—Ç–∞—Ö (MB)

**–ü—Ä–∏–º–µ—Ä:**
```python
mem = ResourceMonitor.get_memory_usage()
print(f"RAM: {mem['used_mb']}/{mem['total_mb']} MB ({mem['percent']}%)")
# RAM: 1024.5/2048.0 MB (50.0%)
```

---

#### `log_resource_usage()`
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ Elasticsearch.

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```python
@staticmethod
def log_resource_usage()
```

**–õ–æ–≥–∏—Ä—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –°–æ–æ–±—â–µ–Ω–∏–µ: "–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞: CPU X%, RAM Y%"
- –ú–µ—Ç—Ä–∏–∫–∏:
  - `cpu_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç CPU
  - `memory_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç RAM
  - `memory_used_mb` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ MB
  - `memory_total_mb` - –≤—Å–µ–≥–æ MB
  - `metric_type: 'resource_usage'` - —Ç–∏–ø –º–µ—Ç—Ä–∏–∫–∏

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞:**
```json
{
  "@timestamp": "2024-03-15T10:30:00Z",
  "level": "INFO",
  "message": "–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞: CPU 45.2%, RAM 50.0%",
  "cpu_percent": 45.2,
  "memory_percent": 50.0,
  "memory_used_mb": 1024.5,
  "memory_total_mb": 2048.0,
  "metric_type": "resource_usage"
}
```

## –§—É–Ω–∫—Ü–∏–∏

### üîÑ `resource_monitoring_task()`
–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ—Å—É—Ä—Å–æ–≤.

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**
```python
async def resource_monitoring_task(interval: int = 60)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `interval` (int, default=60) - –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –º–µ–∂–¥—É –∑–∞–º–µ—Ä–∞–º–∏

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª (`while True`)
2. –í—ã–∑—ã–≤–∞–µ—Ç `ResourceMonitor.log_resource_usage()`
3. –ñ–¥—ë—Ç `interval` —Å–µ–∫—É–Ω–¥
4. –ü–æ–≤—Ç–æ—Ä—è–µ—Ç

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ü—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É —Å —É—Ä–æ–≤–Ω–µ–º ERROR
- –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É (–Ω–µ –ø–∞–¥–∞–µ—Ç)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
import asyncio
from core.utils.resource_monitor import resource_monitoring_task

# –í lifespan –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
async def lifespan(app: FastAPI):
    # –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
    task = asyncio.create_task(resource_monitoring_task(interval=60))
    yield
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
    task.cancel()
```

## –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- `psutil` –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å—ã, –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
- –ù–µ –≤–∏–¥–∏—Ç —Ä–µ—Å—É—Ä—Å—ã —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—ã

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
- –í—ã–±—Ä–∞–Ω –ø–æ–¥—Ö–æ–¥ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ü—Ä–∏—á–∏–Ω—ã:
  - –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
  - –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ
  - –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–ë—É–¥—É—â–∏–µ –ø–ª–∞–Ω—ã:**
- –í–æ–∑–º–æ–∂–µ–Ω –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –≤–Ω–µ Docker —Å—Ä–µ–¥—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Prometheus exporters
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—ã, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EFK + Grafana

**–°—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
- **Elasticsearch** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫
- **Filebeat** - —Å–±–æ—Ä –ª–æ–≥–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤ (–≤–º–µ—Å—Ç–æ Promtail)
- **Kibana** - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
- **Grafana** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
```
ResourceMonitor ‚Üí log_event() ‚Üí JSON —Ñ–∞–π–ª ‚Üí Filebeat ‚Üí Elasticsearch ‚Üí Grafana
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ JSON —Ñ–æ—Ä–º–∞—Ç–∞:**
- –õ–µ–≥–∫–æ –ø–∞—Ä—Å–∏—Ç—Å—è –≤ Grafana
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –£–¥–æ–±–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ Elasticsearch

### –ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å —Å–±–æ—Ä–∞

**–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 60 —Å–µ–∫—É–Ω–¥**
- –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –Ω–∞–≥—Ä—É–∑–∫–æ–π
- –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤
- –ù–µ —Å–æ–∑–¥–∞—ë—Ç –∏–∑–±—ã—Ç–æ—á–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

**–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**
```python
# –ë–æ–ª–µ–µ —á–∞—Å—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥)
resource_monitoring_task(interval=30)

# –†–µ–¥–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
resource_monitoring_task(interval=300)
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–æ–¥—É–ª–∏
- `core.utils.logger.log_event` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫

### –í–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- `psutil` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
- `asyncio` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤—Ä—É—á–Ω—É—é
```python
from core.utils.resource_monitor import ResourceMonitor

# CPU
cpu = ResourceMonitor.get_cpu_usage()
print(f"CPU –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ {cpu}%")

# RAM
mem = ResourceMonitor.get_memory_usage()
print(f"RAM: {mem['used_mb']}/{mem['total_mb']} MB")
print(f"–î–æ—Å—Ç—É–ø–Ω–æ: {mem['available_mb']} MB")
print(f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: {mem['percent']}%")
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
```python
from core.utils.resource_monitor import ResourceMonitor

# –†–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
ResourceMonitor.log_resource_usage()

# –õ–æ–≥ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Elasticsearch
```

### –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
```python
import asyncio
from core.utils.resource_monitor import resource_monitoring_task

async def main():
    # –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
    task = asyncio.create_task(resource_monitoring_task(60))
    
    # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç...
    await asyncio.sleep(3600)  # 1 —á–∞—Å
    
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
    task.cancel()

asyncio.run(main())
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI
```python
from contextlib import asynccontextmanager
from fastapi import FastAPI
from core.utils.resource_monitor import resource_monitoring_task

@asynccontextmanager
async def lifespan(app: FastAPI):
    # Startup
    monitoring_task = asyncio.create_task(
        resource_monitoring_task(interval=60)
    )
    
    yield
    
    # Shutdown
    monitoring_task.cancel()
    try:
        await monitoring_task
    except asyncio.CancelledError:
        pass

app = FastAPI(lifespan=lifespan)
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

### –°–≤—è–∑—å —Å logger.py
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç `log_event()` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ—Ç—Ä–∏–∫:
- –õ–æ–≥–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Elasticsearch
- –î–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ Grafana

### –°–≤—è–∑—å —Å metrics_endpoint.py
–ú–æ–¥—É–ª—å `metrics_endpoint.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ResourceMonitor`:
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/metrics/resources` –¥–ª—è Prometheus
- –≠–Ω–¥–ø–æ–∏–Ω—Ç `/metrics/resources/json` –¥–ª—è –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É

### –°–≤—è–∑—å —Å Elasticsearch
–ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ LogIndex:
- –ü–æ–ª–µ `metric_type: 'resource_usage'`
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç –æ–±—ã—á–Ω—ã—Ö –ª–æ–≥–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

## –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞:**
   - –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
   - –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Elasticsearch
   - Grafana —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫–∏ CPU –∏ RAM
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç —Ç—Ä–µ–Ω–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏

2. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º:**
   - CPU –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 90%
   - –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∞–Ω–æ–º–∞–ª–∏—é
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç –∞–ª–µ—Ä—Ç –≤ Grafana
   - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ –æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏

3. **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
   - –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –¥–æ –∏ –ø–æ—Å–ª–µ
   - –í—ã—è–≤–ª–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

4. **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:**
   - –ê–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
   - –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –í–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å—ã, –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
- –ù–µ –≤–∏–¥–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—ã
- –ù–µ –≤–∏–¥–Ω—ã –¥—Ä—É–≥–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

### –¢–æ—á–Ω–æ—Å—Ç—å –º–µ—Ç—Ä–∏–∫
- CPU –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –∑–∞ 1 —Å–µ–∫—É–Ω–¥—É (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤)
- RAM –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –≤ Elasticsearch)

### –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É
- –ö–∞–∂–¥—ã–π –∑–∞–º–µ—Ä CPU –∑–∞–Ω–∏–º–∞–µ—Ç 1 —Å–µ–∫—É–Ω–¥—É
- –ß–∞—Å—Ç—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è interval >= 30 —Å–µ–∫—É–Ω–¥

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–Ω–µ Docker
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Prometheus Node Exporter
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—ã
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- Disk I/O
- Network I/O
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### 3. –ê–ª–µ—Ä—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Alertmanager
- Email/Slack —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 4. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- –•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
- –ì—Ä–∞—Ñ–∏–∫–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### 5. –ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kubernetes HPA
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
```python
# –í main.py –∏–ª–∏ config.py
RESOURCE_MONITORING_INTERVAL = 60  # —Å–µ–∫—É–Ω–¥

# –í lifespan
monitoring_task = asyncio.create_task(
    resource_monitoring_task(interval=RESOURCE_MONITORING_INTERVAL)
)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
–ú–µ—Ç—Ä–∏–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `log_event()`:
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `core/utils/logger.py`
- JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è Elasticsearch
- –£—Ä–æ–≤–µ–Ω—å INFO (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Grafana

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–∞—à–±–æ—Ä–¥—ã

**CPU Usage:**
```
Query: metric_type:"resource_usage"
Visualization: Time series
Y-axis: cpu_percent
```

**Memory Usage:**
```
Query: metric_type:"resource_usage"
Visualization: Time series
Y-axis: memory_percent, memory_used_mb
```

**Resource Overview:**
```
Query: metric_type:"resource_usage"
Panels:
- Gauge: Current CPU %
- Gauge: Current RAM %
- Time series: CPU trend
- Time series: RAM trend
```

### –ê–ª–µ—Ä—Ç—ã

**High CPU:**
```
Condition: cpu_percent > 80
Duration: 5 minutes
Action: Send notification
```

**High Memory:**
```
Condition: memory_percent > 85
Duration: 5 minutes
Action: Send notification
```

## –°–≤—è–∑—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π

–ú–æ–¥—É–ª—å —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤:
- `docs/utils/logger.md` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
- `docs/api/metrics_endpoint.md` - —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –º–µ—Ç—Ä–∏–∫ (–µ—Å–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω)
